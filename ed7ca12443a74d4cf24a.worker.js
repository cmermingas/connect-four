!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,n,t){Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=2)}([function(e,n,t){"use strict";t.d(n,"b",function(){return l}),t.d(n,"a",function(){return u});var r,o=this&&this.__extends||function(e,n){function t(){this.constructor=e}for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)},i=5;!function(e){e[e.Offensive=0]="Offensive",e[e.Defensive=1]="Defensive",e[e.Neutral=2]="Neutral",e[e.Stupid=3]="Stupid"}(r||(r={}));var s=function(){function e(){}return e}(),l=function(e){function n(){e.apply(this,arguments)}return o(n,e),n.prototype.filter=function(e,n){var t=n.columnIndex.map(function(e){return n.cellsPerColumn-e-1}),r=e.filter(function(e){return t[e]>0||e>0&&t[e-1]>0||e<n.columns.length-1&&t[e+1]>0});return r.length>0?r:[e[Math.floor(e.length/2)]]},n}(s),u=function(){function e(e){void 0===e&&(e=null),this.heuristic=e,this.isThinking=!1}return e.prototype.play=function(e){if(!this.isThinking){this.isThinking=!0;var n=void 0;if(this.plannedMoves&&null!==this.plannedMoves[e.lastMove.column])n=this.plannedMoves[e.lastMove.column];else{var t=this._minimaxMove(e,i,e.currentPlayer);n=t.move}return this.plannedMoves=null,this.isThinking=!1,n}},e.prototype.plan=function(e){if(!this.isThinking&&e){this.isThinking=!0,this.plannedMoves=e.columns.map(function(e){return null});for(var n=this.heuristic.filter(e.getAvailableMoves(),e),t=0,r=n;t<r.length;t++){var o=r[t],s=e.copy();s.playAtColumn(o);var l=this._minimaxMove(s,i,s.currentPlayer);this.plannedMoves[o]=l.move}this.isThinking=!1}},e.prototype._minimaxMove=function(e,n,t){var o=e.getAvailableMoves();if(this.heuristic&&(o=this.heuristic.filter(o,e)),e.gameOver||0===n||0===o.length){var i=0;return e.winner===t?i=n+1:e.winner&&(i=-n-1),{move:null,score:i,moveType:r.Neutral}}for(var s,l,u=0,c=0,a=0,h=0,m=e.currentPlayer===t?Math.max:Math.min,v=0,p=o;v<p.length;v++){var f=p[v],y=e.copy();y.playAtColumn(f);var g=this._minimaxMove(y,n-1,t),i=g.score;u+=e.currentPlayer===t&&i<0||e.currentPlayer!==t&&i>0?1:0,c+=e.currentPlayer===t&&i>0||e.currentPlayer!==t&&i<0?1:0,a+=0===i?1:0,h+=g.moveType===r.Defensive?1:0,(void 0===s||s!==m(s,i)||s===i&&Math.random()>=.8)&&(s=i,l=f)}var d=r.Neutral;return h>0?d=r.Offensive:0===s&&u>0?d=r.Defensive:0===s&&c>0?d=r.Stupid:e.currentPlayer===t&&s>0&&u+a>0?d=r.Offensive:e.currentPlayer!==t&&s<0&&u+a>0&&(d=r.Offensive),{move:l,score:s,moveType:d}},e.prototype.reset=function(){this.plannedMoves=null,this.isThinking=!1},e}()},function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r,o=4;!function(e){e[e.Empty=0]="Empty",e[e.Winning=-1]="Winning"}(r||(r={}));var i=function(){function e(e,n){this.columnCount=e,this.cellsPerColumn=n,this.reset()}return e.fromJSON=function(n){var t=new e(n.columnCount,n.cellsPerColumn);return t.currentPlayer=n.currentPlayer,t.gameOver=n.gameOver,t.winner=n.winner,t.moveCount=n.moveCount,t.lastMove={column:n.lastMove.column,cell:n.lastMove.cell},t.columns=n.columns.map(function(e){return e.slice()}),t.columnIndex=n.columnIndex.slice(),t},e.prototype.toJSON=function(){return{columnCount:this.columnCount,cellsPerColumn:this.cellsPerColumn,currentPlayer:this.currentPlayer,gameOver:this.gameOver,winner:this.winner,moveCount:this.moveCount,lastMove:{column:this.lastMove.column,cell:this.lastMove.cell},columns:this.columns.map(function(e){return e.slice()}),columnIndex:this.columnIndex.slice()}},e.prototype.reset=function(){this.currentPlayer=1,this.gameOver=!1,this.winner=0,this.moveCount=0,this.lastMove={column:-1,cell:-1};for(var e=[],n=0;n<this.cellsPerColumn;n++)e.push(r.Empty);var t=[];this.columnIndex=[];for(var o=0;o<this.columnCount;o++)t.push(e.slice()),this.columnIndex.push(this.cellsPerColumn-1);this.columns=t},e.prototype.copy=function(){var n=new e(this.columnCount,this.cellsPerColumn);return n.currentPlayer=this.currentPlayer,n.gameOver=this.gameOver,n.winner=this.winner,n.moveCount=this.moveCount,n.lastMove={column:this.lastMove.column,cell:this.lastMove.cell},n.columns=this.columns.map(function(e){return e.slice()}),n.columnIndex=this.columnIndex.slice(),n},e.prototype.playAtColumn=function(e){var n=!1,t=this.columnIndex[e];return t>=0&&!this.gameOver&&(this.columns[e][t]=this.currentPlayer,this.currentPlayer=this.currentPlayer%2+1,this.moveCount++,this.lastMove={column:e,cell:t},this.columnIndex[e]--,this._checkWinners(),n=!0),n},e.prototype.getAvailableMoves=function(){var e=[];return this.gameOver||this.columnIndex.forEach(function(n,t){n>=0&&e.push(t)}),e},e.prototype.getCell=function(e){return this.columns[e.column]&&this.columns[e.column][e.cell]},e.prototype._checkWinnersAt=function(e,n,t){var i=[1,-1,0,null];if(i.indexOf(t)===-1)return!1;for(var s=[],l=-o+1;l<=o-1;l++){var u={column:e.column+(null===t?0:l),cell:e.cell+(null===t?1:t)*l},c=this.getCell(u);if(c===n||c===r.Winning)s.push(u);else if(s.length<o&&(s=[]),1===l)break}if(s.length>=o)for(var a=0,h=s;a<h.length;a++){var m=h[a];this.columns[m.column][m.cell]=r.Winning}return s.length>=o},e.prototype._checkSeToNwDiagonal=function(e,n){return this._checkWinnersAt(e,n,1)},e.prototype._checkSwToNeDiagonal=function(e,n){return this._checkWinnersAt(e,n,-1)},e.prototype._checkColumnAt=function(e,n){return this._checkWinnersAt(e,n,null)},e.prototype._checkRowAt=function(e,n){return this._checkWinnersAt(e,n,0)},e.prototype._checkWinners=function(){var e=this.getCell(this.lastMove),n=!1;this.moveCount>=2*o-1&&e&&(n=this._checkSeToNwDiagonal(this.lastMove,e),n=this._checkSwToNeDiagonal(this.lastMove,e)||n,n=this._checkRowAt(this.lastMove,e)||n,n=this._checkColumnAt(this.lastMove,e)||n,n&&(this.winner=e,this.gameOver=!0,this.currentPlayer=0))},e.prototype.toString=function(){for(var e="",n=0;n<this.cellsPerColumn;n++){e+=n>0?"\n":"";for(var t=0;t<this.columnCount;t++)e+=(t>0?" ":"")+this.columns[t][n]}return e},e}()},function(e,n,t){"use strict";var r=t(0),o=t(1);t.d(n,"ConnectFourAiPlayerWebWorker",function(){return s});var i;!function(e){e[e.Play=0]="Play",e[e.Plan=1]="Plan",e[e.Reset=2]="Reset",e[e.PlayDone=3]="PlayDone",e[e.PlanDone=4]="PlanDone"}(i||(i={}));var s=function(){function e(e,n,t,r){var o=this;this.game=e,this.myNumber=n,this.worker=t,this.performMove=r,this.terminated=!1,t.onmessage=function(e){return o.processMessage(e.data)}}return e.prototype.processMessage=function(e){switch(e.command){case i.PlayDone:this.turnTaken(e.data);break;case i.PlanDone:this.game.currentPlayer===this.myNumber&&this.takeTurn()}},e.prototype.takeTurn=function(){var e={command:i.Play,data:this.game.toJSON()};this.worker.postMessage(e)},e.prototype.turnTaken=function(e){this.terminated||this.performMove(e,this)},e.prototype.reset=function(e){this.game=e;var n={command:i.Reset,data:null};this.worker.postMessage(n)},e.prototype.terminate=function(){this.worker.terminate(),this.terminated=!0},e}(),l=new r.a(new r.b);onmessage=function(e){var n=e.data;switch(n.command){case i.Play:var t=o.a.fromJSON(n.data),r=l.play(t),s={command:i.PlayDone,data:r};postMessage(s,void 0),t.playAtColumn(r),l.plan(t);break;case i.Reset:l.reset()}}}]);