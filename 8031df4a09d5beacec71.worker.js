!function(n){function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var t={};return e.m=n,e.c=t,e.i=function(n){return n},e.d=function(n,e,t){Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:t})},e.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},e.p="",e(e.s=2)}([function(n,e,t){"use strict";t.d(e,"b",function(){return u}),t.d(e,"a",function(){return l});var r,o=this&&this.__extends||function(n,e){function t(){this.constructor=n}for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)},i=4;!function(n){n[n.Offensive=0]="Offensive",n[n.Defensive=1]="Defensive",n[n.Neutral=2]="Neutral",n[n.Stupid=3]="Stupid"}(r||(r={}));var s=function(){function n(){}return n}(),u=function(n){function e(){n.apply(this,arguments)}return o(e,n),e.prototype.filter=function(n,e){var t=e.columnIndex.map(function(n){return e.cellsPerColumn-n-1}),r=n.filter(function(n){return t[n]>0||n>0&&t[n-1]>0||n<e.columns.length-1&&t[n+1]>0});return r.length>0?r:[n[Math.floor(n.length/2)]]},e}(s),l=function(){function n(n){void 0===n&&(n=null),this.heuristic=n,this.isThinking=!1}return n.prototype.play=function(n){if(!this.isThinking){this.isThinking=!0;var e=void 0;if(this.plannedMoves&&null!==this.plannedMoves[n.lastMove.column])e=this.plannedMoves[n.lastMove.column];else{var t=this._minimaxMove(n,i,n.currentPlayer);e=t.move}return this.plannedMoves=null,this.isThinking=!1,e}},n.prototype.plan=function(n){if(!this.isThinking&&n){this.isThinking=!0,this.plannedMoves=n.columns.map(function(n){return null});for(var e=this.heuristic.filter(n.getAvailableMoves(),n),t=0,r=e;t<r.length;t++){var o=r[t],s=n.copy();s.playAtColumn(o);var u=this._minimaxMove(s,i,s.currentPlayer);this.plannedMoves[o]=u.move}this.isThinking=!1}},n.prototype._minimaxMove=function(n,e,t,o){void 0===o&&(o=null),o=null===o?e:o;var i=n.getAvailableMoves();if(this.heuristic&&(i=this.heuristic.filter(i,n)),n.gameOver||0===o||0===i.length){var s=0;return n.winner===t?s=o+1:n.winner&&(s=-o-1),{move:null,score:s,moveType:r.Neutral}}for(var u,l,c=0,a=0,h=0,m=0,v=n.currentPlayer===t?Math.max:Math.min,f=0,p=i;f<p.length;f++){var y=p[f],g=n.copy();g.playAtColumn(y);var d=this._minimaxMove(g,e,t,o-1),s=d.score;if(c+=n.currentPlayer===t&&s<0||n.currentPlayer!==t&&s>0?1:0,a+=n.currentPlayer===t&&s>0||n.currentPlayer!==t&&s<0?1:0,h+=0===s?1:0,m+=d.moveType===r.Defensive?1:0,(void 0===u||u!==v(u,s)||u===s&&Math.random()>=.8)&&(u=s,l=y),o===e&&g.gameOver&&g.winner===t)break}var P=r.Neutral;return m>0?P=r.Offensive:0===u&&c>0?P=r.Defensive:0===u&&a>0?P=r.Stupid:n.currentPlayer===t&&u>0&&c+h>0?P=r.Offensive:n.currentPlayer!==t&&u<0&&c+h>0&&(P=r.Offensive),{move:l,score:u,moveType:P}},n.prototype.reset=function(){this.plannedMoves=null,this.isThinking=!1},n}()},function(n,e,t){"use strict";t.d(e,"a",function(){return s});var r,o=4;!function(n){n[n.Empty=0]="Empty",n[n.Winning=-1]="Winning"}(r||(r={}));var i=function(){function n(n){this.content=n}return n}(),s=function(){function n(n,e){this.columnCount=n,this.cellsPerColumn=e,this.reset()}return n.fromJSON=function(e){var t=new n(e.columnCount,e.cellsPerColumn);return t.currentPlayer=e.currentPlayer,t.gameOver=e.gameOver,t.winner=e.winner,t.moveCount=e.moveCount,t.lastMove={column:e.lastMove.column,cell:e.lastMove.cell},t.columns=e.columns.map(function(n){return n.map(function(n){return new i(n)})}),t.columnIndex=e.columnIndex.slice(),t},n.prototype.toJSON=function(){return{columnCount:this.columnCount,cellsPerColumn:this.cellsPerColumn,currentPlayer:this.currentPlayer,gameOver:this.gameOver,winner:this.winner,moveCount:this.moveCount,lastMove:{column:this.lastMove.column,cell:this.lastMove.cell},columns:this.columns.map(function(n){return n.map(function(n){return n.content})}),columnIndex:this.columnIndex.slice()}},n.prototype.reset=function(){this.currentPlayer=1,this.gameOver=!1,this.winner=0,this.moveCount=0,this.lastMove={column:-1,cell:-1};for(var n=[],e=0;e<this.cellsPerColumn;e++)n.push(new i(r.Empty));var t=[];this.columnIndex=[];for(var o=0;o<this.columnCount;o++)t.push(n.map(function(n){return new i(n.content)})),this.columnIndex.push(this.cellsPerColumn-1);this.columns=t},n.prototype.copy=function(){var e=new n(this.columnCount,this.cellsPerColumn);return e.currentPlayer=this.currentPlayer,e.gameOver=this.gameOver,e.winner=this.winner,e.moveCount=this.moveCount,e.lastMove={column:this.lastMove.column,cell:this.lastMove.cell},e.columns=this.columns.map(function(n){return n.map(function(n){return new i(n.content)})}),e.columnIndex=this.columnIndex.slice(),e},n.prototype.playAtColumn=function(n){var e=!1,t=this.columnIndex[n];return t>=0&&!this.gameOver&&(this.columns[n][t]=new i(this.currentPlayer),this.currentPlayer=this.currentPlayer%2+1,this.moveCount++,this.lastMove={column:n,cell:t},this.columnIndex[n]--,this._checkWinners(),e=!0),e},n.prototype.getAvailableMoves=function(){var n=[];return this.gameOver||this.columnIndex.forEach(function(e,t){e>=0&&n.push(t)}),n},n.prototype.getCell=function(n){return this.columns[n.column]&&this.columns[n.column][n.cell]&&this.columns[n.column][n.cell].content},n.prototype._checkWinnersAt=function(n,e,t){var s=[1,-1,0,null];if(s.indexOf(t)===-1)return!1;for(var u=[],l=-o+1;l<=o-1;l++){var c={column:n.column+(null===t?0:l),cell:n.cell+(null===t?1:t)*l},a=this.getCell(c);if(a===e||a===r.Winning)u.push(c);else if(u.length<o&&(u=[]),1===l)break}if(u.length>=o)for(var h=0,m=u;h<m.length;h++){var v=m[h];this.columns[v.column][v.cell]=new i(r.Winning)}return u.length>=o},n.prototype._checkSeToNwDiagonal=function(n,e){return this._checkWinnersAt(n,e,1)},n.prototype._checkSwToNeDiagonal=function(n,e){return this._checkWinnersAt(n,e,-1)},n.prototype._checkColumnAt=function(n,e){return this._checkWinnersAt(n,e,null)},n.prototype._checkRowAt=function(n,e){return this._checkWinnersAt(n,e,0)},n.prototype._checkWinners=function(){var n=this.getCell(this.lastMove),e=!1;this.moveCount>=2*o-1&&n&&(e=this._checkSeToNwDiagonal(this.lastMove,n),e=this._checkSwToNeDiagonal(this.lastMove,n)||e,e=this._checkRowAt(this.lastMove,n)||e,e=this._checkColumnAt(this.lastMove,n)||e,e&&(this.winner=n,this.gameOver=!0,this.currentPlayer=0))},n.prototype.toString=function(){for(var n="",e=0;e<this.cellsPerColumn;e++){n+=e>0?"\n":"";for(var t=0;t<this.columnCount;t++)n+=(t>0?" ":"")+this.columns[t][e].content}return n},n}()},function(n,e,t){"use strict";var r=t(0),o=t(1);t.d(e,"ConnectFourAiPlayerWebWorker",function(){return s});var i;!function(n){n[n.Play=0]="Play",n[n.Plan=1]="Plan",n[n.Reset=2]="Reset",n[n.PlayDone=3]="PlayDone",n[n.PlanDone=4]="PlanDone"}(i||(i={}));var s=function(){function n(n,e,t,r){var o=this;this.game=n,this.myNumber=e,this.worker=t,this.performMove=r,this.terminated=!1,t.onmessage=function(n){return o.processMessage(n.data)}}return n.prototype.processMessage=function(n){switch(n.command){case i.PlayDone:this.turnTaken(n.data);break;case i.PlanDone:this.game.currentPlayer===this.myNumber&&this.takeTurn()}},n.prototype.takeTurn=function(){var n={command:i.Play,data:this.game.toJSON()};this.worker.postMessage(n)},n.prototype.turnTaken=function(n){this.terminated||this.performMove(n,this)},n.prototype.reset=function(n){this.game=n;var e={command:i.Reset,data:null};this.worker.postMessage(e)},n.prototype.terminate=function(){this.worker.terminate(),this.terminated=!0},n}(),u=new r.a(new r.b);onmessage=function(n){var e=n.data;switch(e.command){case i.Play:var t=o.a.fromJSON(e.data),r=u.play(t),s={command:i.PlayDone,data:r};postMessage(s,void 0),t.playAtColumn(r);break;case i.Reset:u.reset()}}}]);